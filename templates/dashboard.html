{% extends 'base.html' %}
{% block title %}Dashboard ‚Äî Temi Kom{% endblock %}
{% block content %}
<div class="row">
  <!-- Sidebar (desktop) -->
  <div class="col-lg-3 d-none d-lg-block">
    <div class="card mb-3 p-3 shadow-sm">
      <div class="d-flex align-items-center gap-3">
        <div class="avatar-initials">TK</div>
        <div>
          <div class="fw-bold">{{ current_user.full_name or current_user.email }}</div>
          <div class="small text-muted">Software Engineer</div>
        </div>
      </div>

      <hr class="my-3">
      <ul class="nav flex-column small">
        <li class="nav-item"><a class="nav-link" href="{{ url_for('dashboard') }}">üè† Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" href="{{ url_for('projects') }}">üìÅ Projects</a></li>
        <li class="nav-item"><a class="nav-link" href="{{ url_for('profile') }}">üë§ Profile</a></li>
        <li class="nav-item"><a class="nav-link text-danger" href="{{ url_for('logout') }}">üö™ Logout</a></li>
      </ul>
    </div>
  </div>

  <!-- Main -->
  <div class="col-lg-9">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <h4 class="mb-0">Welcome back, {{ current_user.full_name or current_user.email }}</h4>
        <div class="small text-muted">Software Engineer ‚Äî Automation & Cloud</div>
      </div>
      <div>
        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createProjectModal">+ Create Project</button>
      </div>
    </div>

    <!-- Feature cards -->
    <div class="row g-3 mb-4">
      <div class="col-md-6">
        <div class="card h-100 shadow-sm">
          <div class="card-body">
            <h6>Projects</h6>
            <p class="small text-muted mb-2">Manage your portfolio projects and deployments.</p>
            <a class="btn btn-outline-primary btn-sm" href="{{ url_for('projects') }}">View Projects</a>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card h-100 shadow-sm">
          <div class="card-body">
            <h6>Certifications</h6>
            <p class="small text-muted mb-2">Upload certificates and badges here later.</p>
            <a class="btn btn-outline-secondary btn-sm" href="#">Coming soon</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Recent Projects -->
    <div>
      <h5 class="mb-3">Recent Projects</h5>
      <div class="row g-3">
        {% for proj in current_user.projects.order_by(Project.created_at.desc()).limit(3) %}
        <div class="col-md-6">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <div class="d-flex justify-content-between">
                <div>
                  <h6 class="mb-1">{{ proj.title }}</h6>
                  <p class="small text-muted mb-2">{{ proj.status }} ‚Ä¢ {{ proj.tech_stack }}</p>
                  <p class="small text-truncate" style="max-height:48px;overflow:hidden;">{{ proj.description }}</p>
                </div>
                <div class="text-end">
                  {% if proj.deployment_url %}
                    <a href="{{ proj.deployment_url }}" target="_blank" class="small">Live</a>
                  {% endif %}
                  <div class="small text-muted">{{ proj.created_at.strftime('%Y-%m-%d') }}</div>
                </div>
              </div>
              <div class="mt-2">
                <a href="{{ url_for('edit_project', project_id=proj.id) }}" class="btn btn-sm btn-outline-primary">Edit</a>
                <form action="{{ url_for('delete_project', project_id=proj.id) }}" method="post" style="display:inline;">
                  <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
                </form>
              </div>
            </div>
          </div>
        </div>
        {% else %}
        <div class="col-12">
          <div class="card p-4 text-center">
            <p class="mb-0 text-muted">No recent projects ‚Äî create one to showcase your work.</p>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>

<!-- include modal partial -->
{% include 'dashboard_create_modal.html' %}
{% endblock %}
